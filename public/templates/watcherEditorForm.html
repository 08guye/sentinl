<div class="modal-header">
  <h3 class="modal-title">Create watcher</h3>
</div>
<div class="modal-body">

<form name="outerForm" class="form-horizontal">
  <tabset active="activeForm">
    <tab index="0" heading="General">
      <div class="form-group">
        <p></p>
      </div>
      <div class="form-group">
        <div class="col-md-2"></div>
        <div class="col-md-6">
          <button
            type="button"
            class="btn btn-sm btn-success"
            ng-click="watcher._source.disable = !watcher._source.disable; toggleWatcher()"
            ng-class="{true: 'btn-warning', false: 'btn-success'}[watcher._source.disable]"
            >{{form.status}}</button>
        </div>
      </div>
      <div class="form-group">
        <label class="col-md-2 control-label" for="title">Title:</label>
        <div class="col-md-6">
          <input
            type="text"
            id="title"
            name="title"
            value="{{watcher._source.title}}"
            class="form-control"
            placeholder="{{watcher._source.uuid}}"
            ng-model="watcher._source.title"
            ng-disabled="form.disabled">
        </div>
      </div>
      <div class="form-group">
        <label class="col-md-2 control-label" for="schedule">Schedule:</label>
        <div class="col-md-6">
          <input
            type="text"
            id="schedule"
            name="schedule"
            value="{{watcher._source.trigger.schedule.later}}"
            class="form-control"
            placeholder="every 1m"
            ng-model="watcher._source.trigger.schedule.later"
            ng-disabled="form.disabled">
        </div>
          <!-- TO-DO: add timepicker and datepicker -->
          <!-- angular ui v0.12
          <timepicker
            ng-model="form.time.now"
            ng-change="changed()"
            hour-step="form.time.hstep"
            minute-step="form.time.mstep"
            show-meridian="form.time.ismeridian"></timepicker>
          -->
          <!-- angular ui v2.5
          <div uib-timepicker
            ng-model="form.time.now"
            ng-change="changed()"
            hour-step="form.time.hstep"
            minute-step="form.time.mstep"
            show-meridian="form.time.ismeridian"
            ng-disabled="disabled"></div>
        </div>
          -->
      </div>
    </tab>
    <tab index="1" heading="Input" select="getInput()">
      <div class="form-group">
        <p></p>
      </div>
      <div class="form-group">
        <div class="col-md-12">
          <div id="inputEdit" class="aceditor">{{ watcher._source.input | json }}</div>
        </div>
      </div>
    </tab>
    <tab index="2" heading="Condition" select="getCondition()">
      <div class="form-group">
        <p></p>
      </div>
      <div class="form-group">
        <div class="col-md-12">
          <div id="conditionEdit"
            class="aceditor"
            ui-ace="aceOptions"
            ng-model="watcher._source.condition.script.script">{{watcher._source.condition.script.script}}</div>
        </div>
      </div>
    </tab>
    <tab index="3" heading="Transform" select="getTransform()">
      <div class="form-group">
        <p></p>
      </div>
      <div class="form-group">
        <div class="col-md-12">
          <div id="transformEdit"
            class="aceditor"
            ui-ace="aceOptions"
            ng-model="watcher._source.transform.script.script">{{watcher._source.transform.script.script}}</div>
        </div>
      </div>
    </tab>
    <tab index="4" heading="Actions">
      <div class="form-group">
        <p></p>
      </div>

      <div class="form-group">
        <div class="col-md-12">
          <div class="form-group">
            <ul ng-repeat="(name, properties) in watcher._source.actions" style="list-style-type:none;">
              <li>
                <a href="" ng-click="editAction(name, properties)">{{name}}</a>

                <!-- Start of webhook template  -->
                <div ng-show="form.actions.toEdit[name]">
                  <div class="form-group">
                    <label class="col-md-2 control-label" for="webhookTitle">Title:</label>
                    <div class="col-md-6">
                      <input
                        type="text"
                        id="webhookTitle"
                        name="webhookTitle"
                        value="{{name}}"
                        class="form-control"
                        placeholder="{{watcher._source.uuid}}"
                        ng-model="watcher._source.actions[name].$title"
                        ng-disabled="form.disabled">
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="col-md-2 control-label" for="webhookHost">Method:</label>
                    <div class="btn-group col-md-2" dropdown is-open="status.isopen">
                      <button type="button" class="btn btn-default btn-md dropdown-toggle" dropdown-toggle ng-disabled="form.disabled">
                        {{properties.webhook.method}} <span class="caret"></span>
                      </button>
                      <ul class="dropdown-menu" role="menu">
                        <li><a href="#">POST</a></li>
                        <li><a href="#">GET</a></li>
                      </ul>
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="col-md-2 control-label" for="webhookHost">Host:</label>
                    <div class="col-md-6">
                      <input
                        type="text"
                        id="webhookHost"
                        name="webhookHost"
                        value="{{properties.webhook.host}}"
                        class="form-control"
                        placeholder="remote.server"
                        ng-model="properties.webhook.host"
                        ng-disabled="form.disabled">
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="col-md-2 control-label" for="webhookPort">Port:</label>
                    <div class="col-md-2">
                      <input
                        type="text"
                        id="webhookPort"
                        name="webhookPort"
                        value="{{properties.webhook.port}}"
                        class="form-control"
                        placeholder="9200"
                        ng-model="properties.webhook.port"
                        ng-disabled="form.disabled">
                    </div>
                    <div class="col-md-3">
                      <label class="checkbox">
                        <input type="checkbox"
                          ng-model="form.actions.webhook.viaProxy"
                          ng-click="enableAdvancedFields('webhook', name, form.actions.webhook.viaProxy)"
                          ng-checked="properties.webhook.headers && properties.webhook.path"> via proxy
                      </label>
                    </div>
                  </div>
                  <div class="form-group" ng-if="properties.webhook.path">
                    <label class="col-md-2 control-label" for="webhookPath">Path:</label>
                    <div class="col-md-6">
                      <input
                        type="text"
                        id="webhookPath"
                        name="webhookPath"
                        value="{{properties.webhook.path}}"
                        class="form-control"
                        placeholder=":/{{payload.watcher_id}"
                        ng-model="properties.webhook.path"
                        ng-disabled="form.disabled">
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="col-md-2 control-label" for="webhookBody">Body:</label>
                    <div class="col-md-6">
                      <div id="webhookBody" class="aceditor">{{ properties.webhook.body | json }}</div>
                    </div>
                  </div>
                  <div class="form-group" ng-if="properties.webhook.headers">
                    <label class="col-md-2 control-label" for="webhookHeaders">Headers:</label>
                    <div class="col-md-6">
                      <div id="webhookHeaders" class="aceditor">{{ properties.webhook.headers | json }}</div>
                    </div>
                  </div>
                </div>
                <!-- End of webhook template  -->

              </li>
            </ul>
          </div>
        </div>
      </div>


    </tab>
  </tabset>
</form>
</div>
<div class="modal-footer">
  <button class="btn btn-success" ng-click="save()">Save</button>
  <button class="btn btn-warning" ng-click="cancel()">Cancel</button>
</div>
